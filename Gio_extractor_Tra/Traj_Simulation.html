<!DOCTYPE html>
<meta charset="utf-8" />
<html>

<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <style type="text/css">
    html {
      height: 100%
    }
    
    body {
      height: 100%;
      margin: 0;
      padding: 0
    }
    
    #map {
      height: 100%;
      width: 100%
    }
  </style>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCUp43Wc-IhupBCbhqg25W-Q8KthEeXriA&v=3.exp&sensor=false&libraries=geometry"></script>


  <script type="text/javascript">
    var line;

    var map;
    var pointDistances;

    function initialize() {
      var mapOptions = {
        center: new google.maps.LatLng(30.065533, 31.278334),
        zoom:45,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };




      map = new google.maps.Map(document.getElementById('map'), mapOptions);

      // var myLatLng = {lat: 2.941660, lng: 101.594207}; //2.852888, 101.651970
      // 2.941660, 101.594207


      // var marker = new google.maps.Marker({
      //    position: myLatLng,
      //    map: map,
      //    title: 'Hello World!'
      // });
      var lineCoordinates = [

     
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065567 ,31.278334),
new google.maps.LatLng(30.065567 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065550 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334),
new google.maps.LatLng(30.065533 ,31.278334)     ];

      map.setCenter(lineCoordinates[0]);

      // point distances from beginning in %
      var sphericalLib = google.maps.geometry.spherical;

      pointDistances = [];
      var pointZero = lineCoordinates[0];
      var wholeDist = sphericalLib.computeDistanceBetween(
        pointZero,
        lineCoordinates[lineCoordinates.length - 1]);

      for (var i = 0; i < lineCoordinates.length; i++) {
        pointDistances[i] = 100 * sphericalLib.computeDistanceBetween(
          lineCoordinates[i], pointZero) / wholeDist;
        console.log('pointDistances[' + i + ']: ' + pointDistances[i]);
      }

      // define polyline
      var lineSymbol = {
        path: google.maps.SymbolPath.CIRCLE,
        scale: 6,
        strokeColor: '#393'
      };

      line = new google.maps.Polyline({
        path: lineCoordinates,
        strokeColor: '#FF0000',
        strokeOpacity: 2.0,
        strokeWeight: 5,
        icons: [{
          icon: lineSymbol,
          offset: '100%'
        }],
        map: map
      });

      animateCircle();
    }


    var id;

    function animateCircle() {
      var count = 0;
      var offset;
      var sentiel = -1;

      id = window.setInterval(function() {
        count = (count + 1) % 200;
        offset = count / 2;

        for (var i = pointDistances.length - 1; i > sentiel; i--) {
          if (offset > pointDistances[i]) {
            console.log('create marker');
            var marker = new google.maps.Marker({
              icon: {
                url: "https://maps.gstatic.com/intl/en_us/mapfiles/markers2/measle_blue.png",
                size: new google.maps.Size(7, 7),
                anchor: new google.maps.Point(4, 4)
              },
              position: line.getPath().getAt(i),
              title: line.getPath().getAt(i).toUrlValue(6),
              map: map
            });

            sentiel++;
            break;
          }
        }

        // we have only one icon
        var icons = line.get('icons');
        icons[0].offset = (offset) + '%';
        line.set('icons', icons);

        if (line.get('icons')[0].offset == "99.5%") {
          icons[0].offset = '100%';
          line.set('icons', icons);
          window.clearInterval(id);
        }

      }, 20);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
  </script>


</head>

<body>
  <div id='map'></div>
</body>

</html>